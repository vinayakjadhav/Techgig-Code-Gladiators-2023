Input
6 7
2
4 6
1 2 2
1 5 4
2 3 5
2 6 2
4 3 1
5 6 8
6 4 3
Output
8
